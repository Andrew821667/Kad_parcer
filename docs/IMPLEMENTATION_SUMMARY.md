# ‚úÖ –†–ï–ó–Æ–ú–ï –†–ï–ê–õ–ò–ó–ê–¶–ò–ò: –ü–∞—Ä—Å–µ—Ä –ö–ê–î –ê—Ä–±–∏—Ç—Ä (5 –ª–µ—Ç)

## üéØ –ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

–°–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ **1.75 –º–∏–ª–ª–∏–æ–Ω–æ–≤ —Å—É–¥–µ–±–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π** –∞—Ä–±–∏—Ç—Ä–∞–∂–Ω—ã—Ö —Å—É–¥–æ–≤ –ú–æ—Å–∫–æ–≤—Å–∫–æ–≥–æ –æ–∫—Ä—É–≥–∞ –∑–∞ **2020-2025 –≥–æ–¥—ã**.

---

## üì¶ –ù–æ–≤—ã–µ –º–æ–¥—É–ª–∏

### 1. `src/scraper/playwright_scraper.py`
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ë—Ä–∞—É–∑–µ—Ä–Ω—ã–π –ø–∞—Ä—Å–µ—Ä –Ω–∞ –æ—Å–Ω–æ–≤–µ Playwright, –æ–±—Ö–æ–¥—è—â–∏–π HTTP 451

**–ö–ª—é—á–µ–≤—ã–µ —Ñ–∏—á–∏:**
- ‚úÖ –ó–∞–ø—É—Å–∫ Firefox/Chromium/Webkit –≤ headless —Ä–µ–∂–∏–º–µ
- ‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –≤–µ–±-—Ñ–æ—Ä–º (–Ω–µ –ø—Ä—è–º—ã–µ API –∑–∞–ø—Ä–æ—Å—ã!)
- ‚úÖ –°–ª—É—á–∞–π–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ 3-5 —Å–µ–∫—É–Ω–¥ (–ø—Ä–æ—Ç–∏–≤ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏)
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ HTML —Ç–∞–±–ª–∏—Ü —Å BeautifulSoup
- ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ: –Ω–æ–º–µ—Ä –¥–µ–ª–∞, —Å—É–¥, —Å—Ç–æ—Ä–æ–Ω—ã, URL, —Ç–∏–ø –¥–µ–ª–∞
- ‚úÖ Context manager –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è –±—Ä–∞—É–∑–µ—Ä–∞

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```python
from src.scraper.playwright_scraper import PlaywrightScraper

async with PlaywrightScraper(headless=True) as scraper:
    results = await scraper.search_by_court_and_date(
        court_code="–ê40",
        date_from="01.01.2024",
        date_to="31.01.2024"
    )
    # results = [{"case_number": "...", "url": "...", ...}, ...]
```

**–ú–µ—Ç–æ–¥ –∏–∑:** `Semendilov/kad-project` (–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ —Å GitHub)

---

### 2. `src/scraper/parallel_parser.py`
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –£–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –±—Ä–∞—É–∑–µ—Ä–∞–º–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ

**–ö–ª—é—á–µ–≤—ã–µ —Ñ–∏—á–∏:**
- ‚úÖ –û—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á (asyncio.Queue)
- ‚úÖ 5-20 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö workers (–±—Ä–∞—É–∑–µ—Ä–æ–≤)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –≤ JSON
- ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ—à–∏–±–æ–∫ (retry logic)
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å PostgreSQL
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (structlog)
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```python
from src.scraper.parallel_parser import ParallelParser, ParsingTask

tasks = [
    ParsingTask(court_code="–ê40", date_from=date(2024, 1, 1), date_to=date(2024, 1, 31)),
    ParsingTask(court_code="–ê40", date_from=date(2024, 2, 1), date_to=date(2024, 2, 28)),
]

parser = ParallelParser(num_workers=10, headless=True)
await parser.add_tasks(tasks)
await parser.start()

# –ü–∞—Ä—Å–∏–Ω–≥ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
# –ü—Ä–æ–≥—Ä–µ—Å—Å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ parsing_progress.json
```

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
- Master coordinator ‚Üí Task queue ‚Üí 10 workers ‚Üí PostgreSQL
- –ö–∞–∂–¥—ã–π worker = –æ—Ç–¥–µ–ª—å–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä
- –ü—Ä–∏ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–∏ worker –±–µ—Ä–µ—Ç —Å–ª–µ–¥—É—é—â—É—é –∑–∞–¥–∞—á—É

---

### 3. `scripts/parse_moscow_5years.py`
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ì–ª–∞–≤–Ω—ã–π –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞

**–ö–ª—é—á–µ–≤—ã–µ —Ñ–∏—á–∏:**
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è 1,080 –∑–∞–¥–∞—á (18 —Å—É–¥–æ–≤ √ó 60 –º–µ—Å—è—Ü–µ–≤)
- ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è —Å—É–¥–æ–≤ (–∫–∞—Å—Å–∞—Ü–∏—è ‚Üí –∞–ø–µ–ª–ª—è—Ü–∏—è ‚Üí –ø–µ—Ä–≤–∞—è –∏–Ω—Å—Ç–∞–Ω—Ü–∏—è)
- ‚úÖ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º (`--test`)
- ‚úÖ –í–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å —á–µ–∫–ø–æ–∏–Ω—Ç–∞ (`--resume`)
- ‚úÖ Rich UI —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞–º–∏
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –¢–µ—Å—Ç (–∫–∞—Å—Å–∞—Ü–∏—è –∑–∞ 2024)
python scripts/parse_moscow_5years.py --test --workers 3

# –ü–æ–ª–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ (5 –ª–µ—Ç, 18 —Å—É–¥–æ–≤)
python scripts/parse_moscow_5years.py --workers 10 --headless

# –í–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å –ø–æ—Å–ª–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
python scripts/parse_moscow_5years.py --resume --workers 10
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `--workers, -w` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±—Ä–∞—É–∑–µ—Ä–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 5)
- `--headless / --no-headless` - —Ä–µ–∂–∏–º –±—Ä–∞—É–∑–µ—Ä–∞
- `--checkpoint, -c` - —Ñ–∞–π–ª –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
- `--test` - —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º
- `--resume` - –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å —á–µ–∫–ø–æ–∏–Ω—Ç–∞

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  parse_moscow_5years.py (Master)       ‚îÇ
‚îÇ  - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç 1,080 –∑–∞–¥–∞—á              ‚îÇ
‚îÇ  - –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å                 ‚îÇ
‚îÇ  - –ö–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç workers                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ Task Queue  ‚îÇ
        ‚îÇ (asyncio)   ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ                          ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îê
‚îÇ Worker 1  ‚îÇ  ...   ‚îÇ Worker 10  ‚îÇ
‚îÇ (Browser) ‚îÇ        ‚îÇ (Browser)  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îò
    ‚îÇ                         ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
      ‚îÇ   PostgreSQL    ‚îÇ
      ‚îÇ   + Checkpoint  ‚îÇ
      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**
1. Master –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∑–∞–¥–∞—á–∏ (—Å—É–¥ + –º–µ—Å—è—Ü)
2. –ó–∞–¥–∞—á–∏ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –æ—á–µ—Ä–µ–¥—å
3. Workers –∑–∞–±–∏—Ä–∞—é—Ç –∑–∞–¥–∞—á–∏ –∏ –∑–∞–ø—É—Å–∫–∞—é—Ç –±—Ä–∞—É–∑–µ—Ä—ã
4. –ë—Ä–∞—É–∑–µ—Ä—ã –∑–∞–ø–æ–ª–Ω—è—é—Ç —Ñ–æ—Ä–º—ã –Ω–∞ kad.arbitr.ru
5. HTML –ø–∞—Ä—Å–∏—Ç—Å—è BeautifulSoup
6. –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ PostgreSQL
7. –ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ JSON checkpoint

---

## üìä –ü–æ–∫—Ä—ã—Ç–∏–µ –¥–∞–Ω–Ω—ã–º–∏

### –°—É–¥—ã (18 —Å—É–¥–æ–≤ –ú–æ—Å–∫–æ–≤—Å–∫–æ–≥–æ –æ–∫—Ä—É–≥–∞):

**–ö–∞—Å—Å–∞—Ü–∏—è (1):**
- –ê40-–ö–° - –ê—Ä–±–∏—Ç—Ä–∞–∂–Ω—ã–π —Å—É–¥ –ú–æ—Å–∫–æ–≤—Å–∫–æ–≥–æ –æ–∫—Ä—É–≥–∞

**–ê–ø–µ–ª–ª—è—Ü–∏—è (1):**
- –ê40-–ê–ü - –î–µ–≤—è—Ç—ã–π –∞—Ä–±–∏—Ç—Ä–∞–∂–Ω—ã–π –∞–ø–µ–ª–ª—è—Ü–∏–æ–Ω–Ω—ã–π —Å—É–¥

**–ü–µ—Ä–≤–∞—è –∏–Ω—Å—Ç–∞–Ω—Ü–∏—è (16):**
- –ê40 - –ú–æ—Å–∫–≤–∞
- –ê41 - –ú–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
- –ê56 - –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥
- –ê13 - –í–æ–ª–æ–≥–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
- –ê05 - –ê—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
- –ê66 - –¢–≤–µ—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
- –ê21 - –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
- –ê26 - –ö–∞—Ä–µ–ª–∏—è
- –ê42 - –ú—É—Ä–º–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
- –ê44 - –ù–æ–≤–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
- –ê52 - –ü—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
- –ê54 - –†—è–∑–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
- –ê14 - –í–æ—Ä–æ–Ω–µ–∂—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
- –ê36 - –õ–∏–ø–µ—Ü–∫–∞—è –æ–±–ª–∞—Å—Ç—å
- –ê08 - –ë–µ–ª–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å
- –ê64 - –¢–∞–º–±–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å

### –ü–µ—Ä–∏–æ–¥:
- **2020-2025** (5 –ø–æ–ª–Ω—ã—Ö –ª–µ—Ç)
- –†–∞–∑–±–∏–≤–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º: 60 –º–µ—Å—è—Ü–µ–≤ √ó 18 —Å—É–¥–æ–≤ = **1,080 –∑–∞–¥–∞—á**

### –û–∂–∏–¥–∞–µ–º—ã–π –æ–±—ä–µ–º:
- **~1.75 –º–∏–ª–ª–∏–æ–Ω–∞ —Å—É–¥–µ–±–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π**

---

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Playwright –±—Ä–∞—É–∑–µ—Ä—ã
playwright install firefox

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ PostgreSQL
brew services start postgresql

# 3. –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
createdb kad_arbitr

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏
alembic upgrade head
```

### –®–∞–≥ 2: –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫ (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!)

```bash
python scripts/parse_moscow_5years.py --test --workers 3
```

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç:**
- –û—Ç–∫—Ä–æ—é—Ç—Å—è 3 –±—Ä–∞—É–∑–µ—Ä–∞ Firefox (headless)
- –°–ø–∞—Ä—Å–∏—Ç—Å—è —Å—É–¥ –ê40-–ö–° –∑–∞ 2024 –≥–æ–¥ (~30,000 –¥–µ–ª)
- –í—Ä–µ–º—è: 1-2 –¥–Ω—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç–µ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã

### –®–∞–≥ 3: –ü–æ–ª–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞:

```bash
python scripts/parse_moscow_5years.py --workers 10 --headless
```

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç:**
- 10 –±—Ä–∞—É–∑–µ—Ä–æ–≤ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
- –ü–∞—Ä—Å–∏–Ω–≥ ~1.75 –º–ª–Ω –¥–µ–ª
- –í—Ä–µ–º—è: ~15 –¥–Ω–µ–π –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã
- –ú–æ–∂–Ω–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å (Ctrl+C) –∏ –≤–æ–∑–æ–±–Ω–æ–≤–ª—è—Ç—å (`--resume`)

---

## ‚è±Ô∏è –í—Ä–µ–º–µ–Ω–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏

### –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:

```
1 –±—Ä–∞—É–∑–µ—Ä:
  - 1 –¥–µ–ª–æ –∑–∞ 4 —Å–µ–∫—É–Ω–¥—ã (–∑–∞–¥–µ—Ä–∂–∫–∞)
  - 15 –¥–µ–ª/–º–∏–Ω—É—Ç—É
  - 900 –¥–µ–ª/—á–∞—Å
  - 21,600 –¥–µ–ª/–¥–µ–Ω—å

10 –±—Ä–∞—É–∑–µ—Ä–æ–≤:
  - 150 –¥–µ–ª/–º–∏–Ω—É—Ç—É
  - 9,000 –¥–µ–ª/—á–∞—Å
  - 216,000 –¥–µ–ª/–¥–µ–Ω—å

–í—Ä–µ–º—è –Ω–∞ 1.75M –¥–µ–ª:
  - 1,750,000 / 216,000 = 8.1 –¥–Ω—è (–∏–¥–µ–∞–ª—å–Ω–æ)
  - –° —É—á–µ—Ç–æ–º –æ—à–∏–±–æ–∫: +20% = ~10 –¥–Ω–µ–π
  - –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑: 12-15 –¥–Ω–µ–π
```

### –§–∞–∑—ã:

| –§–∞–∑–∞ | –°—É–¥—ã | –ü–µ—Ä–∏–æ–¥ | –û–±—ä–µ–º | –í—Ä–µ–º—è |
|------|------|--------|-------|-------|
| –¢–µ—Å—Ç | –ê40-–ö–° (1) | 2024 (1 –≥–æ–¥) | ~30,000 | 1-2 –¥–Ω—è |
| –ü–æ–ª–Ω—ã–π | 18 —Å—É–¥–æ–≤ | 2020-2025 (5 –ª–µ—Ç) | ~1.75M | 12-15 –¥–Ω–µ–π |

---

## üíæ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (PostgreSQL):

**–¢–∞–±–ª–∏—Ü–∞ `cases`:**
```sql
CREATE TABLE cases (
    id SERIAL PRIMARY KEY,
    case_number VARCHAR(50) UNIQUE NOT NULL,
    court_code VARCHAR(10) NOT NULL,
    case_type VARCHAR(50),
    url TEXT NOT NULL,
    plaintiff TEXT,
    respondent TEXT,
    case_date DATE,
    parsed_at TIMESTAMP,

    -- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (–∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –Ω–∞ —ç—Ç–∞–ø–µ 2)
    judge_name VARCHAR(255),
    legal_articles TEXT[],
    case_category VARCHAR(100),
    decision_status VARCHAR(50),

    full_text TEXT
);
```

**–ß—Ç–æ –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è —Å–µ–π—á–∞—Å:**
- ‚úÖ –ù–æ–º–µ—Ä –¥–µ–ª–∞ (case_number)
- ‚úÖ –°—É–¥ (court_code)
- ‚úÖ –¢–∏–ø –¥–µ–ª–∞ (case_type): –∫–∞—Å—Å–∞—Ü–∏—è/–∞–ø–µ–ª–ª—è—Ü–∏—è/–ø–µ—Ä–≤–∞—è –∏–Ω—Å—Ç–∞–Ω—Ü–∏—è
- ‚úÖ URL –∫–∞—Ä—Ç–æ—á–∫–∏ (url)
- ‚úÖ –ò—Å—Ç–µ—Ü (plaintiff)
- ‚úÖ –û—Ç–≤–µ—Ç—á–∏–∫–∏ (respondent)

**–ß—Ç–æ –±—É–¥–µ—Ç –∏–∑–≤–ª–µ—á–µ–Ω–æ –Ω–∞ —ç—Ç–∞–ø–µ 2:**
- ‚è∏Ô∏è –°—É–¥—å—è (judge_name) - –ø–∞—Ä—Å–∏–Ω–≥ HTML –∫–∞—Ä—Ç–æ—á–∫–∏
- ‚è∏Ô∏è –°—Ç–∞—Ç—å–∏ –∑–∞–∫–æ–Ω–æ–≤ (legal_articles) - regex –∏–ª–∏ NLP
- ‚è∏Ô∏è –ö–∞—Ç–µ–≥–æ—Ä–∏—è –¥–µ–ª–∞ (case_category) - –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
- ‚è∏Ô∏è –°—Ç–∞—Ç—É—Å —Ä–µ—à–µ–Ω–∏—è (decision_status) - –∞–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞

---

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ (—Ä–µ–∞–ª—Ç–∞–π–º):

```
‚úì 245 | ‚úó 3 | ‚è≥ 832 | üìä 125,430 –¥–µ–ª
```

### –§–∞–π–ª –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (`parsing_progress.json`):

```json
{
  "timestamp": "2025-12-09T15:30:00Z",
  "total_cases": 125430,
  "completed_tasks": 245,
  "failed_tasks": 3
}
```

### –õ–æ–≥–∏ (structlog):

```bash
tail -f logs/kad_parser.log
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:

```bash
# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ–ª
psql -U postgres kad_arbitr -c "SELECT COUNT(*) FROM cases;"

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—É–¥–∞–º
psql -U postgres kad_arbitr -c "SELECT court, COUNT(*) FROM cases GROUP BY court;"
```

---

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –î–ª—è MacBook M4 Pro (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏):

```bash
python scripts/parse_moscow_5years.py \
  --workers 10 \
  --headless \
  --checkpoint my_progress.json
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- **10 workers** - –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è 10-14 —è–¥–µ—Ä CPU
- **Headless** - —ç–∫–æ–Ω–æ–º–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤
- **Checkpoint** - –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

| –°–∏—Å—Ç–µ–º–∞ | CPU | RAM | Workers | –°–∫–æ—Ä–æ—Å—Ç—å |
|---------|-----|-----|---------|----------|
| MacBook M1 Pro | 8 —è–¥–µ—Ä | 16 GB | 5-8 | ~7K –¥–µ–ª/—á–∞—Å |
| MacBook M4 Pro | 14 —è–¥–µ—Ä | 24 GB | 10-15 | ~12K –¥–µ–ª/—á–∞—Å |
| Cloud Server | 16 —è–¥–µ—Ä | 32 GB | 20 | ~20K –¥–µ–ª/—á–∞—Å |

---

## üõ°Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –¢–∏–ø—ã –æ—à–∏–±–æ–∫ –∏ recovery:

1. **HTTP 451 (rate limit)**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π retry —á–µ—Ä–µ–∑ 60 –º–∏–Ω—É—Ç
   - –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±—Ä–∞—É–∑–µ—Ä–∞
   - –ó–∞–¥–∞—á–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å

2. **Timeout**
   - 3 –ø–æ–ø—ã—Ç–∫–∏ —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π (1, 2, 4 –º–∏–Ω—É—Ç—ã)
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ structlog

3. **Parsing error**
   - HTML —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
   - –ó–∞–¥–∞—á–∞ –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ failed
   - –ú–æ–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å

4. **DB connection error**
   - –ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –ø–∞–º—è—Ç–∏
   - Retry –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ checkpoint –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–º —Å–±–æ–µ

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

1. **`docs/PARSING_GUIDE.md`**
   - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∑–∞–ø—É—Å–∫—É
   - –ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–∞–Ω–¥
   - –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º (troubleshooting)
   - FAQ

2. **`docs/PARSING_PLAN_5YEARS.md`**
   - –î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –ø–∞—Ä—Å–∏–Ω–≥–∞
   - –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö 18 —Å—É–¥–æ–≤
   - –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
   - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

3. **`docs/IMPLEMENTATION_SUMMARY.md`** (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
   - –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
   - –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
   - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (–¥–ª—è —Å–ø—Ä–∞–≤–∫–∏):

- `/tmp/FINAL_SUMMARY.md` - –∏—Ç–æ–≥–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
- `/tmp/PARSING_PLAN_5YEARS.md` - –¥—É–±–ª–∏–∫–∞—Ç –ø–ª–∞–Ω–∞
- `/tmp/letter_to_pravotech.md` - —à–∞–±–ª–æ–Ω—ã –ø–∏—Å–µ–º –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

### –§–∞–∑–∞ 1 (—Ç–µ—Å—Ç):
- ‚úÖ –°–ø–∞—Ä—Å–µ–Ω–æ 100% –¥–µ–ª —Å—É–¥–∞ –ê40-–ö–° –∑–∞ 2024
- ‚úÖ –ö–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö >99%
- ‚úÖ –°–∫–æ—Ä–æ—Å—Ç—å >5,000 –¥–µ–ª/—á–∞—Å
- ‚úÖ –û—à–∏–±–æ–∫ <0.1%

### –§–∞–∑–∞ 2 (–ø–æ–ª–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥):
- ‚úÖ –°–ø–∞—Ä—Å–µ–Ω–æ >95% –æ—Ç 1.75M –¥–µ–ª
- ‚úÖ –í—Å–µ 18 —Å—É–¥–æ–≤ –ø–æ–∫—Ä—ã—Ç—ã
- ‚úÖ –ü–µ—Ä–∏–æ–¥ 2020-2025 –ø–æ–ª–Ω–æ—Å—Ç—å—é
- ‚úÖ –ë–∞–∑–∞ –≥–æ—Ç–æ–≤–∞ –∫ –æ–±–æ–≥–∞—â–µ–Ω–∏—é –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–∞—Ä—Å–∏–Ω–≥–∞:

**–≠—Ç–∞–ø 2–ê: –û–±–æ–≥–∞—â–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏**
1. –°–∫–∞—á–∞—Ç—å HTML –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–µ–ª (–∏—Å–ø–æ–ª—å–∑—É—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ URLs)
2. –ò–∑–≤–ª–µ—á—å —Å—É–¥–µ–π (–ø–∞—Ä—Å–∏–Ω–≥ HTML)
3. –ò–∑–≤–ª–µ—á—å —Å—Ç–∞—Ç—å–∏ –∑–∞–∫–æ–Ω–æ–≤ (regex: "—Å—Ç. 123 –ì–ö –†–§")
4. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (NLP –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è)
5. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç–∞—Ç—É—Å—ã —Ä–µ—à–µ–Ω–∏–π

**–≠—Ç–∞–ø 2–ë: –í–∞–ª–∏–¥–∞—Ü–∏—è**
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–Ω–æ—Ç—ã –¥–∞–Ω–Ω—ã—Ö
3. –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑

**–≠—Ç–∞–ø 3: –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ**
- –î–æ–±–∞–≤–∏—Ç—å 2015-2019 (–µ—â–µ 5 –ª–µ—Ç)
- –ò–õ–ò –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ –¥—Ä—É–≥–∏–µ –æ–∫—Ä—É–≥–∞ –†–§
- –ò–õ–ò –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –µ–∂–µ–º–µ—Å—è—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

**–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö:**
1. –ß–∏—Ç–∞–π—Ç–µ `docs/PARSING_GUIDE.md` (FAQ —Å–µ–∫—Ü–∏—è)
2. –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏: `tail -f logs/kad_parser.log`
3. –°–º–æ—Ç—Ä–∏—Ç–µ checkpoint: `cat parsing_progress.json`

**–ü–∏—Å—å–º–æ –≤ –ü—Ä–∞–≤–æ–¢–µ—Ö (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ):**
- Email: support_kad@pravo.tech
- –®–∞–±–ª–æ–Ω: `/tmp/letter_to_pravotech.md`
- –°—Ç–∞—Ç—É—Å: –∂–¥–µ–º –æ—Ç–≤–µ—Ç–∞

---

## üéâ –ò—Ç–æ–≥

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∑–∞–ø—É—Å–∫—É!**

‚úÖ –ö–æ–¥ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –∏–∑ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö GitHub —Ä–µ—à–µ–Ω–∏–π
‚úÖ –û–±—Ö–æ–¥–∏—Ç HTTP 451 —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä–Ω—É—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é
‚úÖ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (5-20 –±—Ä–∞—É–∑–µ—Ä–æ–≤)
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å PostgreSQL
‚úÖ –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚úÖ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:**
```bash
python scripts/parse_moscow_5years.py --test --workers 3
```

**–£–¥–∞—á–∏! üöÄ**
